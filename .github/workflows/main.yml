name: build and deploy
on: 
  workflow_dispatch:
  
jobs:
  build-and-deploy:
   runs-on: ubuntu-20.04
   steps:
   - name: Install SSH Key
     uses: shimataro/ssh-key-action@v2
     with:
      key: ${{ secrets.PSD_RASP }}
      known_hosts: 'just-a-placeholder-so-we-dont-get-errors'
   - name: deploy
     uses: easingthemes/ssh-deploy@main
     env:
       # 本地.ssh文件下的私钥id_rsa，存在secrets的PRIVATE_KEY中
       SSH_PRIVATE_KEY: ${{ secrets.PSD_RASP}}
       # 复制操作的参数。"-avzr --delete"意味部署时清空服务器目标目录下的文件
       ARGS: "-avzr --delete" 
       # 源目录，相对于$GITHUB_WORKSPACE根目录的路径
       SOURCE: "dashboard/"
       # 服务器域名/IP
       REMOTE_HOST: ${{ secrets.SSH_HOST }}
       # 服务器用户名
       REMOTE_USER:  ${{ secrets.SSH_USER }}
       # 目标目录
       TARGET: '/home/www/dist'
       # 排除目录
       EXCLUDE: "/node_modules/"
